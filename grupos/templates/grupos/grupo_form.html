{% extends "base.html" %}
{% load i18n staticfiles %}

{% block contenido %}
<div class="container">
    <div class="card">
        <div class="card-header">
            <h1 class="f-700">
                <legend><h3>{% trans 'Grupo' %}</h3></legend>
            </h1>
            {% if form.non_field_errors %}
                <div class="row">
                    <div class="alert alert-danger alert-dismissible" role="alert">
                        <button class="close" aria-label="close" data-dismiss="alert" type="button"><span aria-hidden="true">x</span></button>
                        {{ form.non_field_errors }}
                    </div>
                </div>
            {% endif %}
        </div>
        <form action="" method="POST">
            {% csrf_token %}

            <div class="card-body card-padding">
                <div class="row">
                    <div class="col-md-4">
                        <div class="input-group {{ form.parent.css_classes }}">
                            <span class="input-group-addon">
                                <i class="zmdi zmdi-map"></i>
                            </span>
                            <div class="fg-line">
                                <label for="{{ form.parent.id_for_label }}" class="fg-label control-label">{{ form.parent.label }}*:</label>
                                {% if form.instance.pk %}
                                    <p>{{ form.instance.parent }}</p>
                                {% else %}
                                    {{ form.parent }}
                                {% endif %}
                            </div>
                            {{ form.parent.errors }}
                        </div>
                    </div>
                    <div class="col-md-8">
                        <div class="input-group {{ form.lideres.css_classes }}">
                            <span class="input-group-addon">
                                <i class="zmdi zmdi-account"></i>
                            </span>
                            <div class="fg-line">
                                <label for="{{ form.lideres.id_for_label }}" class="fg-label control-label">{{ form.lideres.label }}*:</label>
								{{ form.lideres }}
                            </div>
                            <small class="help-block">{% trans 'Recuerde que los lideres escogidos se volveran discipulos del grupo padre.' %}</small>
                            {{ form.lideres.errors }}
                        </div>
                    </div>
                    <br class="space">
                </div>
                <br>
                <br class="space-down">
                <div class="row">
                    <div class="col-md-4">
                        <div class="input-group {{ form.estado.css_classes }}">
                            <span class="input-group-addon">
                                <i class="zmdi zmdi-refresh"></i>
                            </span>
                            <div class="fg-line requerido">
                                <label for="{{ form.estado.id_for_label }}" class="fg-label control-label">{{ form.estado.label }}*:</label>
                            	{{ form.estado }}
                            </div>
							{{ form.estado.errors }}
                        </div>
                    </div>
                    <br class="space">
                    <div class="col-md-4">
                        <div class="input-group {{ form.fechaApertura.css_classes }}">
                            <span class="input-group-addon">
                                <i class="zmdi zmdi-calendar"></i>
                            </span>
                            <div class="fg-line">
                                <label for="{{ form.fechaApertura.id_for_label }}" class="fg-label control-label">{{ form.fechaApertura.label }}*:</label>
                            	{{ form.fechaApertura }}
                            </div>
                            {{ form.fechaApertura.errors }}
                        </div>
                    </div>
                    <br class="space">
                    <div class="col-md-4">
                        <div class="input-group {{ form.diaGAR.css_classes }}">
                            <span class="input-group-addon">
                                <i class="zmdi zmdi-calendar"></i>
                            </span>
                            <div class="fg-line">
                                <label for="{{ form.diaGAR.id_for_label }}" class="fg-label control-label">Dia del {% if dominioIglesia == "gng.com" %}G.A.A*{% else %}G.A.R*{% endif %}:</label>
                            	{{ form.diaGAR }}
                            </div>
                            {{ form.diaGAR.errors }}
                        </div>
                    </div>
                </div>
                <br>
                <br class="space-down">
                <div class="row">
                    <div class="col-md-4">
                        <div class="input-group {{ form.horaGAR.css_classes }}">
                            <span class="input-group-addon">
                                <i class="zmdi zmdi-time"></i>
                            </span>
                            <div class="fg-line">
                                <label for="{{ form.horaGAR.id_for_label }}" class="fg-label control-label">Hora del {% if dominioIglesia == "gng.com" %}G.A.A*{% else %}G.A.R*{% endif %}:</label>
                            	{{ form.horaGAR }}
                            </div>
                            {{ form.horaGAR.errors }}
                        </div>
                    </div>
                    <br class="space">
                    <div class="col-md-4">
                        <div class="input-group {{ form.diaDiscipulado.css_classes }}">
                            <span class="input-group-addon">
                                <i class="zmdi zmdi-calendar-note"></i>
                            </span>
                            <div class="fg-line">
                                <label for="{{ form.diaDiscipulado.id_for_label }}" class="fg-label control-label">{{ form.diaDiscipulado.label }}:</label>
                            	{{ form.diaDiscipulado }}
                            </div>
                            {{ form.diaDiscipulado.errors }}
                        </div>
                    </div>
                    <br class="space">
                    <div class="col-md-4">
                        <div class="input-group {{ form.horaDiscipulado.css_classes }}">
                            <span class="input-group-addon">
                                <i class="zmdi zmdi-time"></i>
                            </span>
                            <div class="fg-line">
                                <label for="{{ form.horaDiscipulado.id_for_label }}" class="fg-label control-label">{{ form.horaDiscipulado.label }}:</label>
                            	{{ form.horaDiscipulado }}
                            </div>
                            {{ form.horaDiscipulado.errors }}
                        </div>
                    </div>
                </div>
                <br>
                <br class="space-down">
                <div class="row">
                    <div class="col-md-4">
                        <div class="input-group {{ form.direccion.css_classes }}">
                            <span class="input-group-addon">
                                <i class="zmdi zmdi-map"></i>
                            </span>
                            <div class="fg-line">
                                <label for="{{ form.direccion.id_for_label }}" class="fg-label control-label">{{ form.direccion.label }}*:</label>
                                {{ form.direccion }}
                            </div>
                            {{ form.direccion.errors }}
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="input-group {{ form.nombre.css_classes }}">
                            <span class="input-group-addon">
                                <i class="zmdi zmdi-account"></i>
                            </span>
                            <div class="fg-line">
                                <label for="{{ form.nombre.id_for_label }}" class="fg-label control-label">{{ form.nombre.label }}*:</label>
                            	{{ form.nombre }}
                            </div>
                            {{ form.nombre.errors }}
                        </div>
                    </div>
                    <br class="space">
                    <div class="col-md-4">
                        <div class="input-group {{ form.barrio.css_classes }}">
                            <span class="input-group-addon">
                                <i class="zmdi zmdi-pin"></i>
                            </span>
                            <div class="fg-line">
                                <label for="{{ form.barrio.id_for_label }}" class="fg-label control-label">{{ form.barrio.label }}*:</label>
                            	{{ form.barrio }}
                            </div>
                            {{ form.barrio.errors }}
                        </div>
                    </div>
                </div>
                <br>
                <br>
                <br>
                <br>
                <div class="row">
                    <div class="col-md-4 col-md-offset-4">
                        <button name="aceptar" class="btn btn-primary btn-block">{% trans 'Aceptar' %}</button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>
{% endblock contenido %}

{% block js %}
<script src="{% static 'Scripts/funciones.js' %}" type="text/javascript"></script>
<script src="{% static 'Scripts/IGSearch.js' %}" type="text/javascript"></script>
<script type="text/javascript">
	$(document).ready(function(){
		$("#id_fechaApertura").datetimepicker({
            maxDate : moment(),
            format: 'DD/MM/YYYY'
        });

        var selected_before = new Array();

        {% if form.errors %}
            {% for value in grupo_errors %}
                selected_before.push(['{{ value.0 }}', '{{ value.1 }}']);
            {% endfor %}
        {% elif form.instance.id %}
            {% for value in form.instance.lideres.all %}
                selected_before.push(['{{ value.id }}', '{{ value }}']);
            {% endfor %}
        {% endif %}

        $('#{{ form.lideres.id_for_label }}').IGSearch({
            url: "{% url 'common:busqueda_miembro_api' red_id %}",
            key: 'miembros',
            items: selected_before,
            messageError: 'Ha ocurrido un error y no se pueden mostrar los lideres',
            prerequest: function (options) {
                options.data.grupo = '{{ grupo_id|safe }}';
                return true;
            }
        });
	});
</script>
{% endblock js %}
